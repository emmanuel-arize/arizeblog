<!DOCTYPE html>
<html lang=" en ">
<style>
    #ma {
        margin-right: 150px;
        /* background-color: white; */
    }

    body {
        font-size: 15px;
        padding: 75px;
    }
</style><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Introduction to Customer Segmentation | ARIZE-BLOG</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Introduction to Customer Segmentation" />
<meta name="author" content="Arize Emmanuel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this post, I’ll focus on customer segmentation and provide practical examples using k-means algorithm." />
<meta property="og:description" content="In this post, I’ll focus on customer segmentation and provide practical examples using k-means algorithm." />
<link rel="canonical" href="http://localhost:4000/arizeblog/machine-learning-python/2023/04/15/Customers-Segment.html" />
<meta property="og:url" content="http://localhost:4000/arizeblog/machine-learning-python/2023/04/15/Customers-Segment.html" />
<meta property="og:site_name" content="ARIZE-BLOG" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Introduction to Customer Segmentation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Arize Emmanuel"},"dateModified":"2023-04-15T00:00:00+00:00","datePublished":"2023-04-15T00:00:00+00:00","description":"In this post, I’ll focus on customer segmentation and provide practical examples using k-means algorithm.","headline":"Introduction to Customer Segmentation","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/arizeblog/machine-learning-python/2023/04/15/Customers-Segment.html"},"url":"http://localhost:4000/arizeblog/machine-learning-python/2023/04/15/Customers-Segment.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/arizeblog/assets/main.css">
    <link rel="stylesheet" href="/arizeblog/%20/assets/css/w3.css">
    <link rel="stylesheet" href="/arizeblog/%20/assets/css/bootstrap.min.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/arizeblog/feed.xml" title="ARIZE-BLOG" /></head>
<body class="w3-light-grey"><!-- Sidebar -->
<div class="w3-top">

    <div class="w3-container w3-bar w3-teal ">
        <div style="padding-left: 100px">

            <a href="/arizeblog/" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b>Home</b></a>

            <a href="/arizeblog/machine-learning-python" class="w3-bar-item w3-button w3-hide-small w3-text-black">
                <b>ML. with Python </b>
            </a>

            <a href=" /arizeblog/machine-learning-R" class="w3-bar-item w3-button w3-hide-small w3-text-black">
                <b>ML. with R </b>
            </a>
            <a href="/arizeblog/Power-BI" class="w3-bar-item w3-button w3-hide-small w3-text-black">
                <b>Power BI (DAX) </b>
                <a href="/arizeblog/Power-Query" class="w3-bar-item w3-button w3-hide-small w3-text-black">
                    <b>Power Query (M)</b>
                </a>
                <!-- <a href="/arizeblog/VBA" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b>VBA</b></a> -->
                <a href="/arizeblog/Excel" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b> Excel</b></a>


                <a href="/arizeblog/about" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b>About</b></a>
                  <a href="/arizeblog/Portfolio" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b>Portfolio</b></a>


                <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium"
                onclick="myFunction()">&#9776;</a>
</div>
    </div>

    <div id="demo" class="w3-bar-block w3-gray w3-hide w3-hide-large w3-hide-medium">
        <a href="/arizeblog/machine-learning-python" class="w3-bar-item w3-button w3-text-black">
            <b>Machine Learning Python</b>
        </a>

        <a href="/arizeblog/machine-learning-R" class="w3-bar-item w3-button w3-text-black">
            <b>Machine Learning R</b>
        </a>

        <a href=" /arizeblog/Power-BI" class="w3-bar-item w3-button w3-text-black">
            <b>Power BI (DAX & M)</b>
        </a>

        <a href="/arizeblog/Power-Query" class="w3-bar-item w3-button w3-hide-small w3-text-black">
            <b>Power Query</b>


            <a href="/arizeblog/Excel" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b>Excel</b> </a>
            <a href="/arizeblogg/about" class="w3-bar-item w3-button w3-text-black"><b>About </b></a>
            <a href="/arizeblog/Portfolio" class="w3-bar-item w3-button w3-hide-small w3-text-black"><b>Portfolio</b></a>


    </div>
</div>

<script>
    function myFunction() {
        var x = document.getElementById("demo");
        if (x.className.indexOf("w3-show") == -1) {
            x.className += " w3-show";
        } else {
            x.className = x.className.replace(" w3-show", "");
        }
    }
</script>
<br style="margin-top:2px;">
    <div class="w3-container">
        <style>
img {
    display: block;
    margin-left: auto;
    margin-right: auto;
}
</style>
<div class="w3-row  w3-white">

        <div class=" w3-col w3-container w3-margin w3-round-large" style="width:79%;left:0;">


            <header class="post-header">
                <h2 class="post-title p-name" itemprop="name headline">Introduction to Customer Segmentation</h2>
                <p class="post-meta">
                    <time class="dt-published" datetime="2023-04-15T00:00:00+00:00" itemprop="datePublished">Apr 15, 2023
                    </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person">
                        <span class="p-author h-card" itemprop="name">
                            By Arize Emmanuel
                        </span>
                    </span></p>
            </header>

            <div class="post-content e-content" itemprop="articleBody">
                <span class="w3-container"> <p>In this post, I’ll focus on customer segmentation and provide practical examples using k-means algorithm.</p>

<p>A company serve a wide range of customers with unique interests, having different sensitivities to price, product preferences and requirements which cannot be satisfied by using a single one-size-fits-all marketing campaign. As a marketing analyst you cannot also personalize marketing campaigns for each customer, instead, marketers use cluster analysis to discover pattern within the customers (customers data) and partition them into distinct homogenous segments so that observations within each segment are quite similar to each other, while observations in different segments are quite different from each other. This is perceived as an important business opportunity because by identifying subgroups of people who might be more receptive to a particular form of advertising, or more likely to purchase a particular product, this allow a company to maximize the use of it limited resources. Since we are writing about customers segmentation, what Is Customer Segmentation?</p>

<h3 id="what-is-customer-segmentation">What Is Customer Segmentation?</h3>
<p><strong>Customers segmentation</strong> is the process of partitioning a target customers  into segments where customers within each segment are similar and collectively different from customers in other segments. The general goal of customer segmentation is to identify subgroups of customers with common characteristics and wants. It assumes that different segments of customer  require different marketing campaigns and a company might segment their customers based on  demographic, psychographic, geographic, and behavioral.</p>

<h2 id="why-is-customer-segmentation-important">Why is customer segmentation important?</h2>

<p>Customers have different sensitivities to price, product preferences and requirements. Markets are also saturated with attractive products and services, of which many are in direct competition with your product, services and marketing offerings, so by identifying the differences and similarities between potential customer segments, and with a deep understanding of each segment, a marketer can make better strategic choices about opportunities, develop more competitive and attractive offerings tailor to the specific requirements of each segment to better satisfy their wants that aim to outweigh the bundle of benefits provided by your competitors. This make marketing campaigns more effective and provide a significant boost to the company and also improve customer service.</p>

<p>There are many clustering techniques  (unsupervised machine learning algorithms) that can help companies segment their customers but in this post I will focus on a very commonly used technique known as <strong>K-means clustering</strong>. Before diving into K-Means clustering let first load the mall customers data that will be used in this post and preprocess it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">"OMP_NUM_THREADS"</span><span class="p">]</span> <span class="o">=</span> <span class="s">'1'</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"./data/Mall_Customers.csv"</span><span class="p">)</span>
<span class="n">mall_data</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Gender</th>
      <th>Age</th>
      <th>Annual Income (k$)</th>
      <th>Spending Score (1-100)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Male</td>
      <td>19</td>
      <td>15</td>
      <td>39</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Male</td>
      <td>21</td>
      <td>15</td>
      <td>81</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Female</td>
      <td>20</td>
      <td>16</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>

<p>The data contain attributes such as age and gender of the customers, their estimated annual income (Annual Income (k$)) and spending score (Spending Score (1-100)) which denotes the amount of shopping a customer has done at the mall (a higher score means a higher spending ).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 200 entries, 0 to 199
Data columns (total 5 columns):
 #   Column                  Non-Null Count  Dtype
---  ------                  --------------  -----
 0   CustomerID              200 non-null    int64
 1   Gender                  200 non-null    object
 2   Age                     200 non-null    int64
 3   Annual Income (k$)      200 non-null    int64
 4   Spending Score (1-100)  200 non-null    int64
dtypes: int64(4), object(1)
memory usage: 7.9+ KB
</code></pre></div></div>

<p>With the data information provided above we can see that the mall data contain 5 attributes and 200 samples (customers) with no missing values</p>

<p>Let rename the attributes <strong>Annual Income (k$)</strong> to <strong>Income</strong> and <strong>Spending Score (1-100)</strong> to <strong>Spending_Score</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Annual Income (k$)'</span><span class="p">:</span><span class="s">'Income'</span><span class="p">,</span>
                          <span class="s">'Spending Score (1-100)'</span><span class="p">:</span><span class="s">'Spending_Score'</span><span class="p">},</span>
                             <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['CustomerID', 'Gender', 'Age', 'Income', 'Spending_Score'], dtype='object')
</code></pre></div></div>

<h3 id="selecting-clustering-variables">Selecting Clustering Variables</h3>
<p>There are multiple ways to segment customers and because of its exploratory nature, there is always the question of whether the cluster analysis is producing the correct segmentation scheme and is the result useful for targeting your audience? To make the segmentation useful it is important to first define the variables that form the basis of the homogeneous groups of customers because these variables directs the nature of the groups formed and provide insights into the grouped formed. In this post I will segments customers based on their income level and spending scores regardless of the customer gender and age so that we can have different marketing strategy for customers with high income and low spending scores, those with medium income and spending scores versus those with low income and high spending scores.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data_1</span><span class="o">=</span><span class="n">mall_data</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">selected_cols</span><span class="o">=</span><span class="p">[</span><span class="s">'Income'</span><span class="p">,</span> <span class="s">'Spending_Score'</span><span class="p">]</span>
<span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">].</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Income</th>
      <th>Spending_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15</td>
      <td>39</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>81</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let visualize the relationship between income and spending score</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Income</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Spending_Score</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Relationship btw Income and Spending Scrore"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="w3-center" src="/arizeblog/assets/images/python/cust_seg_1.png" />
<br /></p>

<p>From the above graph the seems to be no correlation (relationship) between income and spending score . It also seems to have 5 natural groups</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">].</span><span class="n">corr</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Income</th>
      <th>Spending_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Income</th>
      <td>1.000000</td>
      <td>0.009903</td>
    </tr>
    <tr>
      <th>Spending_Score</th>
      <td>0.009903</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Min income: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">].</span><span class="n">Income</span><span class="p">.</span><span class="nb">min</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Max income: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Income</span><span class="p">.</span><span class="nb">max</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Min spending-score: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Spending_Score</span><span class="p">.</span><span class="nb">min</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Max spending-score: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Spending_Score</span><span class="p">.</span><span class="nb">max</span><span class="p">()))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Min income: 15
Max income: 137
Min spending-score: 1
Max spending-score: 99
</code></pre></div></div>

<h2 id="standardizing--customer-data">Standardizing  Customer Data</h2>
<p>From the minimum and maximum values for Income and Spending score above we can see that the
two segmentation variables are measured on different scale. Since K-Means is distance-based methods of segment extraction, the range of values of a segmentation variable affects its relative influence on the clustering result so to balance the influence of the segmentation variables on the segmentation results, the segmentation variables are standardized to puts them on a common scale. I will standardize the customer data using the z-score standardization which is given as</p>

\[z=\frac{x_{i}-\bar{x}}{s}\]

<p>s=standard deviation</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">z_score</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">]</span><span class="o">=</span><span class="n">z_score</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data_1</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Gender</th>
      <th>Age</th>
      <th>Income</th>
      <th>Spending_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Male</td>
      <td>19</td>
      <td>-1.738999</td>
      <td>-0.434801</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Male</td>
      <td>21</td>
      <td>-1.738999</td>
      <td>1.195704</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Female</td>
      <td>20</td>
      <td>-1.700830</td>
      <td>-1.715913</td>
    </tr>
  </tbody>
</table>
</div>

<p>let now dive into K-means clustering</p>

<h1 id="k-means-clustering">K-Means Clustering</h1>

<p>K-means clustering is an approach for partitioning a dataset into a set of k \((k&lt;n )\)  distinct clusters where k represent the number of clusters and it’s pre-specified by the analyst. Using K-Means algorithmn each observation is assigned to one and only one cluster and can be characterized by a many to-one mapping \(k=C(i)\) that assigns the \(i\)th observation to the \(k\)th cluster with the goal of minimizing the differences within each cluster while maximizing the differences between clusters.</p>

<p>Partitioning customers into subgroups requires a method for computing the dissimilarities or similarities between customers. The choice of similarities (distance) measures is a critical step in clustering as it defines what it means for two or more observations (customers) to be similar or different and also influences the clustering result.
There are several different clustering criteria (distance measure) such as Manhattan and correlation-based distances but in this post squared Euclidean distance is chosen as the dissimilarity measure because with squared euclidean distance, customers with high values of variables tend to cluster together and those with low values of variables also tend to be cluster together and is given as</p>

\[d(x_{i}, x_{i′}) =\sum_{j=1}^{p} \lgroup x_{ij} -x_{i'j} \rgroup ^{2}=|| x_{i} -x_{i'}||^{2}\]

<p>The basic idea behind k-means clustering consist of defining clusters such that the total intra-cluster variation known as total within-cluster sum of square (WSS) which is a measure  of the amount by which the observations within a cluster differ from each other is minimized. The total within-cluster variation  is defined as</p>

\[WSS= \sum_{i \in k}\sum_{j=1}^{p} \lgroup x_{ij} -\mu_{kj} \rgroup ^{2}\]

<p>where k is the cluster, \(x_{ij}\) is the value of the \(j\)th variable for the $i$th observation, \(µ_{kj}\) is the is the centroid for the \(k\)th cluster, and p is the number of variables.</p>

<h2 id="conceptually-the-k-means-algorithm-is-as-follows">Conceptually, the k-means algorithm is as follows:</h2>

<ol>
  <li>
    <p>Specify the number of clusters (K) to be created.</p>
  </li>
  <li>
    <p>Randomly initialize k data points as the initial cluster centers (centroids).</p>
  </li>
  <li>
    <p>Assigns each observation to their closest centroid, based on the Euclidean distance between the observation and the centroid. Each of these centroids represents a cluster.</p>
  </li>
  <li>
    <p>Recalculate the cluster center (new centroids) as the average of its assigned data points</p>
  </li>
  <li>
    <p>Compute the distance between each observation and the new centroids and assign the data point to its closest centroid (new centroids).</p>
  </li>
  <li>
    <p>Iteratively minimize the total within sum of square. That is, iterate steps 4 and 5 until the cluster assignments stop changing (The centroids do not move significantly so observations aren’t reassigned new cluster) or or a maximum number of iterations is reached .</p>
  </li>
</ol>

<h2 id="choosing-the-right-number-of-clusters">Choosing the Right Number Of Clusters</h2>

<p>Determining the optimal number of clusters is a fundamental issue in partitioning clustering.  Features used play important role in defining similarities between clusters (customers). We usually do not know the optimal number of clusters, so there is a need to understand the different ways in choosing the optimal number of clusters. Decisions on the number of clusters can be subjective and depends on the method used for measuring similarities and the features used for partitioning. Choosing k can be subjective so if you have prior domain knowledge as to how many clusters should theoretically be present in a dataset, then you can use this knowledge to guide your selection. There are several approaches for determining the optimal number of clusters including visual inspection, silhouette score, elbow method, gap statistic method and many more  but in this post I will only look at the elbow method. These quantitative measures only tell how well that number of clusters fits the data. They do not tell how useful these clusters are for business. Since, it is the  business analyst that will interpret and act on these clusters, they have to understand the nature of the clusters and what each cluster cares about. So no matter how good these clusters are statistically, they are useless if they are not actionable by the business.</p>

<h3 id="elbow-method">Elbow Method</h3>

<p>The basic idea behind k-means clustering consists of defining clusters such that the total within-cluster sum of square (WSS) is minimized. Using Elbow method, the method looks at the total WSS as a function of the number of clusters. The total WSS will decreases as the number of clusters increases, because each cluster will be smaller and tighter. In this process the hope is that the rate at which the WSS decreases will slow down for k beyond the optimal number of clusters. In other words, the graph of WSS versus k should flatten out beyond the optimal k, so the optimal k will be at the <strong>elbo</strong> of the graph.</p>

<p>The optimal number of clusters can be defined as follow:</p>

<ol>
  <li>Compute k-means clustering for different values of k ,for instance, by varying k from 1 to 10 clusters.</li>
  <li>For each k, calculate the total within-cluster sum of square (wss).</li>
  <li>Plot the curve of wss according to the number of clusters k.</li>
  <li>The location of a bend (knee) in the plot is generally considered as an indicator of the appropriate number of clusters</li>
</ol>

<p>Let’s plot the total  WSS  for up to 15 clusters</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wss</span><span class="o">=</span><span class="p">[]</span>
<span class="n">K</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="n">km</span><span class="o">=</span><span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">km</span><span class="o">=</span><span class="n">km</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">])</span>
    <span class="n">wss</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">km</span><span class="p">.</span><span class="n">inertia_</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">wss</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"WSS vs. number of clusters"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Number of clusters: K"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'WSS'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="w3-center" src="/arizeblog/assets/images/python/cust_seg_2.png" />
<br /></p>

<p>When we look at the graph the peak of the bend,  occurs at around the 5th cluster, indicating that this is the ideal number of clusters. The code below instantiate a KMeans model with 5 number of clusters (n_clusters).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kmeans_model</span><span class="o">=</span><span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<p>Next, fit the model on the data using the selected columns named selected_cols.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kmeans_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">])</span>
</code></pre></div></div>
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style>
<div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=5, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked="" /><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=5, random_state=42)</pre></div></div></div></div></div>

<p>Using the predict method of the k-means model, the code below assign to each customer a cluster with the cluster variable named as Cluster.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data_1</span><span class="p">[</span><span class="s">'Cluster'</span><span class="p">]</span><span class="o">=</span><span class="n">kmeans_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">mall_data_1</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">])</span>
</code></pre></div></div>

<p>Let visualize the data points and their assigned cluster by using different shape and color for each cluster.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s">'x'</span><span class="p">,</span> <span class="s">'*'</span><span class="p">,</span> <span class="s">'+'</span><span class="p">,</span> <span class="s">'|'</span><span class="p">,</span> <span class="s">'_'</span><span class="p">]</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">'violet'</span><span class="p">,</span><span class="s">'red'</span><span class="p">,</span><span class="s">'green'</span><span class="p">,</span><span class="s">'blue'</span><span class="p">,</span><span class="s">'orange'</span><span class="p">]</span>
<span class="n">centroid</span><span class="o">=</span><span class="n">kmeans_model</span><span class="p">.</span><span class="n">cluster_centers_</span>

<span class="k">for</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">mall_data_1</span><span class="p">[</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Cluster</span> <span class="o">==</span> <span class="n">cluster</span><span class="p">]</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">Income</span><span class="p">,</span> <span class="n">temp</span><span class="p">.</span><span class="n">Spending_Score</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">cluster</span><span class="p">],</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">cluster</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">"Cluster "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cluster</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroid</span><span class="p">[</span><span class="n">cluster</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">centroid</span><span class="p">[</span><span class="n">cluster</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Income'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"K-Means Clustering"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Spend_score'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="w3-center" src="/arizeblog/assets/images/python/cust_seg_3.png" />
<br /></p>

<p>Looking at the scatter plot above with clusters represented by different shapes and colors,
the k-means algorithm did a great job of identifying the natural grouping within the data .</p>

<h2 id="understanding-and-describing-the-clusters">Understanding and Describing the Clusters</h2>

<p>As a marketing analyst, you need to have a clear understanding of each segments so that you can explain to the various stakeholders in the business what each cluster (segment) means from a business perspective since they are usually the decision makers. To understand the clusters, one simple approach is to study the various characteristics of the customers based on the relevant features used for clustering and to understand the characteristics of the clusters, we will analyze the features in the original  customer dataset (mall_data)  which does not contain scaled features by adding their predicted clusters to see how Income and Spending_Score varies across the clusters.</p>

<p>the code below add customers predicted clusters to the original mall dataset:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="p">[</span><span class="s">"Cluster"</span><span class="p">]</span><span class="o">=</span><span class="n">mall_data_1</span><span class="p">.</span><span class="n">Cluster</span>
</code></pre></div></div>

<p>To see how Income and Spending_Score varies across the segments, let group the dataset by Cluster and plot the mean value of each cluster using the code below</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Cluster'</span><span class="p">)[[</span><span class="s">'Income'</span><span class="p">,</span><span class="s">'Spending_Score'</span><span class="p">]].</span><span class="n">mean</span><span class="p">().</span><span class="n">plot</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="w3-center" src="/arizeblog/assets/images/python/cust_seg_4.png" />
<br /></p>

<p>Let also sample 10 customers with their predicted clusters</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mall_data</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Gender</th>
      <th>Age</th>
      <th>Income</th>
      <th>Spending_Score</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>25</td>
      <td>Female</td>
      <td>54</td>
      <td>28</td>
      <td>14</td>
      <td>2</td>
    </tr>
    <tr>
      <th>111</th>
      <td>112</td>
      <td>Female</td>
      <td>19</td>
      <td>63</td>
      <td>54</td>
      <td>0</td>
    </tr>
    <tr>
      <th>124</th>
      <td>125</td>
      <td>Female</td>
      <td>23</td>
      <td>70</td>
      <td>29</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td>Female</td>
      <td>35</td>
      <td>21</td>
      <td>35</td>
      <td>2</td>
    </tr>
    <tr>
      <th>138</th>
      <td>139</td>
      <td>Male</td>
      <td>19</td>
      <td>74</td>
      <td>10</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92</th>
      <td>93</td>
      <td>Male</td>
      <td>48</td>
      <td>60</td>
      <td>49</td>
      <td>0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>131</td>
      <td>Male</td>
      <td>47</td>
      <td>71</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>174</th>
      <td>175</td>
      <td>Female</td>
      <td>52</td>
      <td>88</td>
      <td>13</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>Female</td>
      <td>35</td>
      <td>19</td>
      <td>99</td>
      <td>3</td>
    </tr>
    <tr>
      <th>183</th>
      <td>184</td>
      <td>Female</td>
      <td>29</td>
      <td>98</td>
      <td>88</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>

<p>From the above graph and table we can describe the clusters as:</p>

<ul>
  <li><strong>Cluster 0</strong>: Moderate spenders with moderate-income</li>
  <li><strong>Cluster 1</strong>: Low spenders with high-income</li>
  <li><strong>Cluster 2</strong>: Low spenders with low-income</li>
  <li><strong>Cluster 3</strong>: High spenders with low-income</li>
  <li><strong>Cluster 4</strong>: High spenders with high-income</li>
</ul>

<p>With these clusters, the business can decide to focus on customers in cluster 0,3,4 since these clusters have high spending scores which provide high revenues to the business.</p>
</span>
            </div><a class="u-url" href="/arizeblog/machine-learning-python/2023/04/15/Customers-Segment.html" hidden></a>

        <!-- </article> -->
        </div>

    		<div class="w3-sidebar w3-light-gray w3-card w3-round-xlarge w3-margin-left" style="width:20%;right:0;
                   margin-top: 25px;">
              		<div class="w3-container">
              		<h5><b>Related Posts</b></h5>
              		</div>

                    <ul class="w3-hoverable ">

                               
                               
                               
                               
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2023/04/15/Customers-Segment.html">Introduction to Customer Segmentation
                              </li>
                              
                               
                               
                               
                               
                               
                               
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2021/05/07/INTRODUCTION-TO-LSTM.html">Introduction to LSTMs
                              </li>
                              
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2021/05/06/SIMPLE_RNN.html">Introduction to Recurrent Neural Networks (RNNs)
                              </li>
                              
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2021/03/22/BOWS.html">Feature Extraction with Bag of Words (BOWs)
                              </li>
                              
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2021/02/05/ml-django.html">Deploying A Machine Learning Model Using Django
                              </li>
                              
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2021/01/24/Logistic-Regression.html">Logistic Regression
                              </li>
                              
                               
                               
                              <li class="w3-padding-16">
                                  <a href="/arizeblog/machine-learning-python/2021/01/14/cross-validation.html">Cross-Validation (ML-python)
                              </li>
                              
                               
                              


                          </ul>

            </div>


    </div>


    </div>
    <!--<footer class="site-footer h-card">
  <data class="u-url" href="/arizeblog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">ARIZE-BLOG</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Emmanuel Arize</li><li><a class="u-email" href="mailto:arize2.emmanuel@gmail.com">arize2.emmanuel@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/emmanuel-arize"><svg class="svg-icon"><use xlink:href="/arizeblog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">emmanuel-arize</span></a></li><li><a href="https://www.linkedin.com/in/emmanuel-arize-277270134"><svg class="svg-icon"><use xlink:href="/arizeblog/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">emmanuel-arize-277270134</span></a></li></ul></div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
-->
</body>

</html>
<link rel="stylesheet" href="/arizeblog/assets/css/my.css">
<link rel="stylesheet" href="/arizeblog/assets/css/w3.css">
<link rel="stylesheet" href="/arizeblog/assets/css/bootstrap.min.css">
<script id="MathJax-script" async src="/arizeblog/assets/js/tex-mml-chtml.js"></script>
<script id="MathJax-script" async src="/arizeblog/assets/js/w3.js"></script>
<script id="MathJax-script" async src="/arizeblog/assets/js/bootstrap.min.js"></script>

<script type="text/javascript" id="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.0.0/es5/tex-svg.js">
</script>
